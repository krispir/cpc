<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Rcpp wrapper that calls the C++ chromatogram processing framework — process_chromatogram • cpc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Rcpp wrapper that calls the C++ chromatogram processing framework — process_chromatogram"><meta property="og:description" content="The function takes smoothed d0, d1, and d2 vectors and processes the 
chromatogram by baseline expansion of peaks detected in the second 
derivative. In short, the algorithm detects all peak apices in the 
chromatogram as negative minima craddled by inflection points in the 
second derivative of the chromatogram. Each peak apex detected is then
subjected to a baseline expansion algorithm in order to determine the
peak boundaries and baseline boundaries of the peaks.
It is not recommended to use this function directly unless you know what
you are doing. Instead, use the supplied API functions defined."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cpc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/cpc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rcpp wrapper that calls the C++ chromatogram processing framework</h1>
    
    <div class="hidden name"><code>process_chromatogram.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function takes smoothed d0, d1, and d2 vectors and processes the 
chromatogram by baseline expansion of peaks detected in the second 
derivative. In short, the algorithm detects all peak apices in the 
chromatogram as negative minima craddled by inflection points in the 
second derivative of the chromatogram. Each peak apex detected is then
subjected to a baseline expansion algorithm in order to determine the
peak boundaries and baseline boundaries of the peaks.</p>
<p>It is not recommended to use this function directly unless you know what
you are doing. Instead, use the supplied API functions defined.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">process_chromatogram</span><span class="op">(</span>
  <span class="va">d0</span>,
  <span class="va">d2</span>,
  <span class="va">st</span>,
  apex_thresh <span class="op">=</span> <span class="fl">0</span>,
  w <span class="op">=</span> <span class="fl">5L</span>,
  p <span class="op">=</span> <span class="op">-</span><span class="fl">1L</span>,
  liftoff <span class="op">=</span> <span class="fl">0</span>,
  touchdown <span class="op">=</span> <span class="fl">0.5</span>,
  output <span class="op">=</span> <span class="fl">0L</span>,
  fit_emg <span class="op">=</span> <span class="fl">1L</span>,
  fit_only_vip <span class="op">=</span> <span class="fl">1L</span>,
  fit_hess <span class="op">=</span> <span class="fl">0L</span>,
  fit_rel_lim <span class="op">=</span> <span class="fl">0.05</span>,
  pts_per_peak <span class="op">=</span> <span class="fl">30L</span>,
  min_shoulder_pts <span class="op">=</span> <span class="fl">3L</span>,
  min_rounded_pts <span class="op">=</span> <span class="fl">3L</span>,
  reltol <span class="op">=</span> <span class="fl">1e-08</span>,
  abstol <span class="op">=</span> <span class="op">-</span><span class="fl">1e+35</span>,
  alpha <span class="op">=</span> <span class="fl">1</span>,
  gamma <span class="op">=</span> <span class="fl">2.1</span>,
  rho <span class="op">=</span> <span class="fl">0.75</span>,
  sigma <span class="op">=</span> <span class="fl">0.75</span>,
  maxit <span class="op">=</span> <span class="fl">2000L</span>,
  maxeval <span class="op">=</span> <span class="fl">2000L</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>d0</dt>
<dd><p>Numeric vector containing the smoothed XIC trace</p></dd>
<dt>d2</dt>
<dd><p>Numeric vector containing the second derivative of smoothed XIC</p></dd>
<dt>st</dt>
<dd><p>Numeric vector containing scan times</p></dd>
<dt>apex_thresh</dt>
<dd><p>Second derivative threshold value.</p></dd>
<dt>w</dt>
<dd><p>Apex detection window. Do not change unless you know what you are doing.</p></dd>
<dt>p</dt>
<dd><p>Apex location of a specific peak. Leave blank if you wish to process the entire chromatogram.</p></dd>
<dt>liftoff</dt>
<dd><p>Slope difference threshold (in percent) for the peak front.</p></dd>
<dt>touchdown</dt>
<dd><p>Slope difference threshold (in percent) for the peak tail.</p></dd>
<dt>output</dt>
<dd><p><code>integer</code> value (0 = no output, 1 = verbose output).</p></dd>
<dt>fit_emg</dt>
<dd><p>Indicates if EMG deconvolution should be performed (0 = no EMG deconvolution, 1 = EMG deconvolution will be performed)</p></dd>
<dt>fit_only_vip</dt>
<dd><p>Indicates if EMG deconvolution should be performed on only the selected peak indicated by p (0 = no, 1 = yes)</p></dd>
<dt>fit_hess</dt>
<dd><p>Deprecated.</p></dd>
<dt>fit_rel_lim</dt>
<dd><p>Minimum relative peak height of neighboring peaks to the selected peak that will be deconvoluted.</p></dd>
<dt>pts_per_peak</dt>
<dd><p>Minimum number of points per peak</p></dd>
<dt>min_shoulder_pts</dt>
<dd><p>Minimum number of points between minima and maxima for at least one of the peaks in a shoulder pair</p></dd>
<dt>min_rounded_pts</dt>
<dd><p>Minimum number of points between minima and maxima for at least one of the peaks in a rounded peak pair</p></dd>
<dt>reltol</dt>
<dd><p>Relative tolerance of the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>abstol</dt>
<dd><p>Absolute tolerance of the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>alpha</dt>
<dd><p>Reflection coefficient of the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>gamma</dt>
<dd><p>Expansion coefficient of the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>rho</dt>
<dd><p>Contraction coefficient of the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>sigma</dt>
<dd><p>Shrink coefficient of the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>maxit</dt>
<dd><p>Maximum iterations for the Nelder-Mead minimizer for EMG deconvolution</p></dd>
<dt>maxeval</dt>
<dd><p>Maximum objective function calls for the Nelder-Mead minimizer for EMG deconvolution</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of peak characteristics.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"signal"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">200</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">0.05</span></span>
<span class="r-in"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fl">1e5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span> <span class="co"># create a vector with a gaussian peak</span></span>
<span class="r-in"><span class="va">noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span> <span class="co"># generate a noise vector</span></span>
<span class="r-in"><span class="va">nvec</span> <span class="op">&lt;-</span> <span class="va">vec</span> <span class="op">+</span> <span class="va">noise</span> <span class="co"># create a noisy `chromatogram`.</span></span>
<span class="r-in"><span class="va">smvec</span> <span class="op">&lt;-</span> <span class="fu">signal</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/signal/man/sgolayfilt.html" class="external-link">sgolayfilt</a></span><span class="op">(</span><span class="va">nvec</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># smooth the vector using Savitzky-Golay</span></span>
<span class="r-in"><span class="va">ddsmvec</span> <span class="op">&lt;-</span> <span class="fu">signal</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/signal/man/sgolayfilt.html" class="external-link">sgolayfilt</a></span><span class="op">(</span><span class="va">nvec</span>, n <span class="op">=</span> <span class="fl">5</span>, m <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># get the second derivative of the smoothed vector</span></span>
<span class="r-in"><span class="fu">cpc</span><span class="fu">::</span><span class="fu">process_chromatogram</span><span class="op">(</span>d0 <span class="op">=</span> <span class="va">smvec</span>, d2 <span class="op">=</span> <span class="va">ddsmvec</span>, st <span class="op">=</span> <span class="va">st</span>, apex_thresh <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $current_peak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $d2_apex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $adj_apex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $front_inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 93.86427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tail_inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 104.0671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $front_baseline_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tail_baseline_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $front_peak_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tail_peak_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $front_code</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tail_code</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 99971.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inf_area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 68096.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emg_mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 98.46778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emg_sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.978848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emg_lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.864577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emg_area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100144.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emg_conv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kristian Pirttilä.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

