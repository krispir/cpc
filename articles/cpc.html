<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filtering of chromatographic peaks in an XCMS object • cpc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Filtering of chromatographic peaks in an XCMS object">
<meta property="og:description" content="cpc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cpc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cpc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Filtering of chromatographic peaks in an XCMS
object</h1>
                        <h4 data-toc-skip class="author">Kristian
Pirttilä</h4>
            
            <h4 data-toc-skip class="date">2022-01-12</h4>
      
      
      <div class="hidden name"><code>cpc.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial describes the CPC package functionality on an example
data set included with the package. We will load the example dataset,
perform peak picking using XCMS and apply the CPC algorithm to filter
the peaks detected. Furthermore, we will showcase the data extraction
methods and visualize the results.</p>
<p>The data originates from 4 replicate injections of protein
precipitated plasma on a HILIC platform. The example data is heavily
filtered in order to keep package size and processing times to a
minimum. The filtering is made in two steps: (1) The full data set was
processed using XCMS and CPC in the same way described below. A subset
of 100 peaks was randomly selected from those that were retained in the
filtering step, based on the calculated signal-to-noise of the peaks (25
from each quartile). Similarily 100 peaks were randomly selected from
those removed in the filtering step (33-34 each from those removed due
to not being detected, having too low signal to noise, or having too few
data points along the peak range). (2) The data set was then filtered to
(i) only include scan indices 1-1200, (ii) only include mass peaks with
intensity &gt; 2.225*median intensity (removes a lot of noise peaks),
and (iii) include only mass peaks whose m/z value coincide with one of
the selected peaks in step (1) within a ppm value of 50 and a retention
window of +/- 120 seconds.</p>
</div>
<div class="section level2">
<h2 id="setup-environment">Setup environment<a class="anchor" aria-label="anchor" href="#setup-environment"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ggvenn</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="xcms-processing">XCMS processing<a class="anchor" aria-label="anchor" href="#xcms-processing"></a>
</h2>
<p>The first step in this tutorial is to use XCMS to process the reduced
data set. This step normally takes a long time to run on a full dataset,
however, thanks to the significant filtering made, it should run very
fast on an average desktop PC. For more information on how to use XCMS
for processing LC/MS data, see XCMS documentation. Only the peak picking
will be performed as the retention alignment will not work properly with
this heavily filtered dataset, and is not important to illustrate the
workflow.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># get example raw data file paths from package</span>
<span class="va">fp_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"cpc"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="co"># setup multi-core processing for XCMS</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/BiocParallelParam-class.html" class="external-link">bpstart</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># setup metadata</span>
<span class="op">(</span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"HILIC_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                  sample_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"HILIC_POS"</span>, <span class="fl">4</span><span class="op">)</span>,
                  stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   sample_name sample_group</span>
<span class="co">#&gt; 1     HILIC_1    HILIC_POS</span>
<span class="co">#&gt; 2     HILIC_2    HILIC_POS</span>
<span class="co">#&gt; 3     HILIC_3    HILIC_POS</span>
<span class="co">#&gt; 4     HILIC_4    HILIC_POS</span>

<span class="co"># Create raw data object</span>
<span class="op">(</span><span class="va">msraw</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMSData.html" class="external-link">readMSData</a></span><span class="op">(</span>files <span class="op">=</span> <span class="va">fp_raw</span>,
                              pdata <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="st">"NAnnotatedDataFrame"</span>, <span class="va">pd</span><span class="op">)</span>,
                              mode <span class="op">=</span> <span class="st">"onDisk"</span>, msLevel. <span class="op">=</span> <span class="fl">1</span>, centroided. <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; MSn experiment data ("OnDiskMSnExp")</span>
<span class="co">#&gt; Object size in memory: 1.54 Mb</span>
<span class="co">#&gt; - - - Spectra data - - -</span>
<span class="co">#&gt;  MS level(s): 1 </span>
<span class="co">#&gt;  Number of spectra: 5200 </span>
<span class="co">#&gt;  MSn retention times: 0:02 - 11:18 minutes</span>
<span class="co">#&gt; - - - Processing information - - -</span>
<span class="co">#&gt; Data loaded [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt; Filter: select MS level(s) 1. [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt;  MSnbase version: 2.20.4 </span>
<span class="co">#&gt; - - - Meta data  - - -</span>
<span class="co">#&gt; phenoData</span>
<span class="co">#&gt;   rowNames: 1 2 3 4</span>
<span class="co">#&gt;   varLabels: sample_name sample_group</span>
<span class="co">#&gt;   varMetadata: labelDescription</span>
<span class="co">#&gt; Loaded from:</span>
<span class="co">#&gt;   [1] hilic015.mzML...  [4] hilic021.mzML</span>
<span class="co">#&gt;   Use 'fileNames(.)' to see all files.</span>
<span class="co">#&gt; protocolData: none</span>
<span class="co">#&gt; featureData</span>
<span class="co">#&gt;   featureNames: F1.S0001 F1.S0002 ... F4.S1300 (5200 total)</span>
<span class="co">#&gt;   fvarLabels: fileIdx spIdx ... spectrum (35 total)</span>
<span class="co">#&gt;   fvarMetadata: labelDescription</span>
<span class="co">#&gt; experimentData: use 'experimentData(object)'</span>

<span class="co"># --- PEAK DETECTION ---</span>

<span class="co"># run peak detection</span>
<span class="va">xd</span> <span class="op">&lt;-</span> <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/chromatographic-peak-detection.html" class="external-link">findChromPeaks</a></span><span class="op">(</span><span class="va">msraw</span>, 
                           param <span class="op">=</span> <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks-centWave.html" class="external-link">CentWaveParam</a></span><span class="op">(</span>ppm <span class="op">=</span> <span class="fl">60</span>, 
                                                       peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span><span class="op">)</span>, 
                                                       fitgauss <span class="op">=</span> <span class="cn">T</span>, 
                                                       noise <span class="op">=</span> <span class="fl">200</span>,
                                                       integrate <span class="op">=</span> <span class="fl">2</span>, 
                                                       prefilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1000</span><span class="op">)</span>, 
                                                       verboseColumns <span class="op">=</span> <span class="cn">T</span>, 
                                                       mzdiff <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>, 
                           msLevel <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'BiocGenerics'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     IQR, mad, sd, var, xtabs</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
<span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
<span class="co">#&gt;     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
<span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
<span class="co">#&gt;     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
<span class="co">#&gt;     union, unique, unsplit, which.max, which.min</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Welcome to Bioconductor</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Vignettes contain introductory material; view with</span>
<span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span>
<span class="co">#&gt;     'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'S4Vectors'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand.grid, I, unname</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'ProtGenerics'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     smooth</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This is MSnbase version 2.20.4 </span>
<span class="co">#&gt;   Visit https://lgatto.github.io/MSnbase/ to get started.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'MSnbase'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     trimws</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This is xcms version 3.16.1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'xcms'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     sigma</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Detecting mass traces at 60 ppm ... OK</span>
<span class="co">#&gt; Detecting chromatographic peaks in 1837 regions of interest ... OK: 268 found.</span>
<span class="co">#&gt; Detecting mass traces at 60 ppm ... OK</span>
<span class="co">#&gt; Detecting chromatographic peaks in 1774 regions of interest ... OK: 296 found.</span>
<span class="co">#&gt; Detecting mass traces at 60 ppm ... OK</span>
<span class="co">#&gt; Detecting chromatographic peaks in 1782 regions of interest ... OK: 264 found.</span>
<span class="co">#&gt; Detecting mass traces at 60 ppm ... OK</span>
<span class="co">#&gt; Detecting chromatographic peaks in 1768 regions of interest ... OK: 282 found.</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span>
<span class="co">#&gt; MSn experiment data ("XCMSnExp")</span>
<span class="co">#&gt; Object size in memory: 1.54 Mb</span>
<span class="co">#&gt; - - - Spectra data - - -</span>
<span class="co">#&gt;  MS level(s): 1 </span>
<span class="co">#&gt;  Number of spectra: 5200 </span>
<span class="co">#&gt;  MSn retention times: 0:02 - 11:18 minutes</span>
<span class="co">#&gt; - - - Processing information - - -</span>
<span class="co">#&gt; Data loaded [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt; Filter: select MS level(s) 1. [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt;  MSnbase version: 2.20.4 </span>
<span class="co">#&gt; - - - Meta data  - - -</span>
<span class="co">#&gt; phenoData</span>
<span class="co">#&gt;   rowNames: 1 2 3 4</span>
<span class="co">#&gt;   varLabels: sample_name sample_group</span>
<span class="co">#&gt;   varMetadata: labelDescription</span>
<span class="co">#&gt; Loaded from:</span>
<span class="co">#&gt;   [1] hilic015.mzML...  [4] hilic021.mzML</span>
<span class="co">#&gt;   Use 'fileNames(.)' to see all files.</span>
<span class="co">#&gt; protocolData: none</span>
<span class="co">#&gt; featureData</span>
<span class="co">#&gt;   featureNames: F1.S0001 F1.S0002 ... F4.S1300 (5200 total)</span>
<span class="co">#&gt;   fvarLabels: fileIdx spIdx ... spectrum (35 total)</span>
<span class="co">#&gt;   fvarMetadata: labelDescription</span>
<span class="co">#&gt; experimentData: use 'experimentData(object)'</span>
<span class="co">#&gt; - - - xcms preprocessing - - -</span>
<span class="co">#&gt; Chromatographic peak detection:</span>
<span class="co">#&gt;  method: centWave </span>
<span class="co">#&gt;  1110 peaks identified in 4 samples.</span>
<span class="co">#&gt;  On average 278 chromatographic peaks per sample.</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cpc-peak-filtering">CPC peak filtering<a class="anchor" aria-label="anchor" href="#cpc-peak-filtering"></a>
</h2>
<p>The way in which the CPC package is applied to the workflow is via
two wrapper functions, <em>characterize_peaklist()</em> and
<em>filter_xcms_peaklist()</em>. The first one will only characterize
the peaks detected by XCMS and returns a <em>cpc</em> object, whereas
the second will call <em>characterize_peaklist()</em> as well as run the
filtering method and can return either a <em>cpc</em> object containing
all the information, including the filtered XCMSnExp object, or only the
filtered XCMSnExp object. For incorporating the package into an XCMS
workflow, it is recommended to use the function
<em>filter_xcms_peaklist()</em> with <em>return_type = “xcms”</em> or
use the <em>getFilteredXCMS()</em> method on the <em>cpc</em> object
returned by <em>filter_xcms_peaklist()</em> as both cases will give the
same result. The latter case will be used in this tutorial as we want to
keep the information contained in the <em>cpc</em> object.</p>
<p>The <em>cpcProcParam</em> object holds processing parameters for both
peak characterization as well as peak filtering.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cpc</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_xcms_peaklist.html">filter_xcms_peaklist</a></span><span class="op">(</span>xd <span class="op">=</span> <span class="va">xd</span>, return_type <span class="op">=</span> <span class="st">"cpc"</span>, 
                                 param <span class="op">=</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/cpcProcParam.html">cpcProcParam</a></span><span class="op">(</span>min_sn <span class="op">=</span> <span class="fl">10</span>, 
                                                           min_pts <span class="op">=</span> <span class="fl">10</span>,
                                                           min_intensity <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Processing file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span>
<span class="co">#&gt; Found 268 peak(s).</span>
<span class="co">#&gt; Finished in 5.274 secs.</span>
<span class="co">#&gt; Processing file: /__w/_temp/Library/cpc/extdata/hilic017.mzML</span>
<span class="co">#&gt; Found 296 peak(s).</span>
<span class="co">#&gt; Finished in 5.678 secs.</span>
<span class="co">#&gt; Processing file: /__w/_temp/Library/cpc/extdata/hilic019.mzML</span>
<span class="co">#&gt; Found 264 peak(s).</span>
<span class="co">#&gt; Finished in 5.13 secs.</span>
<span class="co">#&gt; Processing file: /__w/_temp/Library/cpc/extdata/hilic021.mzML</span>
<span class="co">#&gt; Found 282 peak(s).</span>
<span class="co">#&gt; Finished in 5.36 secs.</span>
<span class="co">#&gt; Keeping 923 of 1110 (83.15%) peaks.</span></code></pre></div>
<p>Processing times will depend heavily on the computer hardware used.
With this data set the processing times are very fast (&lt;10 seconds
per file), but that is due to the heavy filtering that has been done.
More realistic processing times, when working with full LC/MS data sets,
range from a 2-10 minutes per file, scaling linearly with the number of
peaks detected by XCMS.</p>
<p>After processing we can get the original peak table from the XCMS
object and the characterized peak table from the CPC object using the
methods <em>cpt</em> and <em>getPeaklist</em>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cpcPeaktable</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu">cpt</span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span></code></pre></div>
<p>The peak table that you get from the CPC package has a number of
determined peak characteristics as well as calculated peak
characteristics.</p>
<table class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>The row number of the peak in the original peak table from
XCMS.</td>
</tr>
<tr class="even">
<td>rt</td>
<td>Peak retention time in seconds.</td>
</tr>
<tr class="odd">
<td>rtmin</td>
<td>Peak front bound in seconds.</td>
</tr>
<tr class="even">
<td>rtmax</td>
<td>Peak tail bound in seconds.</td>
</tr>
<tr class="odd">
<td>rtf1b</td>
<td>Peak front bound at 1% peak height.</td>
</tr>
<tr class="even">
<td>rtt1b</td>
<td>Peak tail bound at 1% peak height.</td>
</tr>
<tr class="odd">
<td>rtf5b</td>
<td>Peak front bound at 5% peak height.</td>
</tr>
<tr class="even">
<td>rtt5b</td>
<td>Peak tail bound at 5% peak height.</td>
</tr>
<tr class="odd">
<td>rtf10b</td>
<td>Peak front bound at 10% peak height.</td>
</tr>
<tr class="even">
<td>rtt10b</td>
<td>Peak tail bound at 10% peak height.</td>
</tr>
<tr class="odd">
<td>rtf50b</td>
<td>Peak front bound at 50% peak height.</td>
</tr>
<tr class="even">
<td>rtt50b</td>
<td>Peak tail bound at 50% peak height.</td>
</tr>
<tr class="odd">
<td>apex</td>
<td>The most intense scan point in the peak.</td>
</tr>
<tr class="even">
<td>finf</td>
<td>The interpolated front inflection point of the peak where the second
derivative crosses zero.</td>
</tr>
<tr class="odd">
<td>tinf</td>
<td>The interpolated tail inflection point of the peak where the second
derivative crosses zero.</td>
</tr>
<tr class="even">
<td>fblb</td>
<td>The determined front baseline boundary scan.</td>
</tr>
<tr class="odd">
<td>tblb</td>
<td>The determined tail baseline boundary scan.</td>
</tr>
<tr class="even">
<td>fpkb</td>
<td>The determined front peak bound.</td>
</tr>
<tr class="odd">
<td>tpkb</td>
<td>The determined tail peak bound.</td>
</tr>
<tr class="even">
<td>fcode</td>
<td>The front peak bound type (B = baseline, V = valley, S = shoulder, R
= rounded peak).</td>
</tr>
<tr class="odd">
<td>tcode</td>
<td>The tail peak bound type (B = baseline, V = valley, S = shoulder, R
= rounded peak).</td>
</tr>
<tr class="even">
<td>blslp</td>
<td>The slope of the baseline calculated between fblb and tblb.</td>
</tr>
<tr class="odd">
<td>emu</td>
<td>The mu value of the fitted exponentially modified gaussian (EMG)
function. This is only calculated if EMG deconvolution is turned
on.</td>
</tr>
<tr class="even">
<td>esigma</td>
<td>The sigma value of the fitted EMG function. This is only calculated
if EMG deconvolution is turned on.</td>
</tr>
<tr class="odd">
<td>elambda</td>
<td>The lambda value of the fitted EMG function. This is only calculated
if EMG deconvolution is turned on.</td>
</tr>
<tr class="even">
<td>earea</td>
<td>The area modifier of the fitted EMG function. This is only
calculated if EMG deconvolution is turned on.</td>
</tr>
<tr class="odd">
<td>econv</td>
<td>An indicator if the Nelder-Mead minimizer converged when performing
EMG deconvolution.</td>
</tr>
<tr class="even">
<td>note</td>
<td>A character statement describing the result of the peak processing.
This can be “detected”, “not_detected”, “too_narrow”, “low_sn”,
“too_small”.</td>
</tr>
<tr class="odd">
<td>height</td>
<td>The peak height calculated between the apex scan point and the
interpolated baseline value at that point.</td>
</tr>
<tr class="even">
<td>fh1b</td>
<td>Front bound at 1% peak height.</td>
</tr>
<tr class="odd">
<td>th1b</td>
<td>Tail bound at 1% peak height.</td>
</tr>
<tr class="even">
<td>fh5b</td>
<td>Front bound at 5% peak height.</td>
</tr>
<tr class="odd">
<td>th5b</td>
<td>Tail bound at 5% peak height.</td>
</tr>
<tr class="even">
<td>fh50b</td>
<td>Front bound at 50% peak height.</td>
</tr>
<tr class="odd">
<td>th50b</td>
<td>Tail bound at 50% peak height.</td>
</tr>
<tr class="even">
<td>wb</td>
<td>Base width of the peak calculated as th5b-fh5b.</td>
</tr>
<tr class="odd">
<td>fwhm</td>
<td>Full width at half maxima of the peak calculated as
th50b-fh50b.</td>
</tr>
<tr class="even">
<td>area</td>
<td>The area of the peak calculated using a trapezoid integrator between
fh1b and th1b.</td>
</tr>
<tr class="odd">
<td>a</td>
<td>
<em>apex</em> - <em>fpkb</em>. Used to calculate the tailing
factor.</td>
</tr>
<tr class="even">
<td>b</td>
<td>
<em>tpkb</em> - <em>apex</em>. Used to calculate the tailing
factor.</td>
</tr>
<tr class="odd">
<td>tf</td>
<td>The tailing factor calculated as <em>tf</em> =
<em>b</em>/<em>a</em>.</td>
</tr>
<tr class="even">
<td>sn</td>
<td>The calculated signal-to-noise ratio calculated as <em>sn</em> =
2**height*/noise.</td>
</tr>
<tr class="odd">
<td>file</td>
<td>Which sample file the peak was detected in.</td>
</tr>
<tr class="even">
<td>exectime</td>
<td>The execution time for the peak in seconds.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="visualizing-the-results">Visualizing the results<a class="anchor" aria-label="anchor" href="#visualizing-the-results"></a>
</h2>
<p>First lets determine which peaks are kept and which are filtered. In
the <em>cpc</em> object, there are two <em>XCMSnExp</em> objects,
<em>xd</em> and <em>xdFilt</em>. <em>xdFilt</em>, as the name implies,
is the filtered <em>XCMSnExp</em> object. It can be extracted using the
<em>filteredObject()</em> method.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># get the original xcms object using getOriginalXCMS()</span>
<span class="va">xdOrig</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu">getOriginalXCMS</span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span>

<span class="va">xdOrig</span>
<span class="co">#&gt; MSn experiment data ("XCMSnExp")</span>
<span class="co">#&gt; Object size in memory: 1.54 Mb</span>
<span class="co">#&gt; - - - Spectra data - - -</span>
<span class="co">#&gt;  MS level(s): 1 </span>
<span class="co">#&gt;  Number of spectra: 5200 </span>
<span class="co">#&gt;  MSn retention times: 0:02 - 11:18 minutes</span>
<span class="co">#&gt; - - - Processing information - - -</span>
<span class="co">#&gt; Data loaded [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt; Filter: select MS level(s) 1. [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt;  MSnbase version: 2.20.4 </span>
<span class="co">#&gt; - - - Meta data  - - -</span>
<span class="co">#&gt; phenoData</span>
<span class="co">#&gt;   rowNames: 1 2 3 4</span>
<span class="co">#&gt;   varLabels: sample_name sample_group</span>
<span class="co">#&gt;   varMetadata: labelDescription</span>
<span class="co">#&gt; Loaded from:</span>
<span class="co">#&gt;   [1] hilic015.mzML...  [4] hilic021.mzML</span>
<span class="co">#&gt;   Use 'fileNames(.)' to see all files.</span>
<span class="co">#&gt; protocolData: none</span>
<span class="co">#&gt; featureData</span>
<span class="co">#&gt;   featureNames: F1.S0001 F1.S0002 ... F4.S1300 (5200 total)</span>
<span class="co">#&gt;   fvarLabels: fileIdx spIdx ... spectrum (35 total)</span>
<span class="co">#&gt;   fvarMetadata: labelDescription</span>
<span class="co">#&gt; experimentData: use 'experimentData(object)'</span>
<span class="co">#&gt; - - - xcms preprocessing - - -</span>
<span class="co">#&gt; Chromatographic peak detection:</span>
<span class="co">#&gt;  method: centWave </span>
<span class="co">#&gt;  1110 peaks identified in 4 samples.</span>
<span class="co">#&gt;  On average 278 chromatographic peaks per sample.</span>

<span class="co"># get the original peak table</span>
<span class="va">xcmsPeaktableOrig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdOrig</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get the filtered xcms object using getFilteredXCMS()</span>
<span class="va">xdFilt</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu">getFilteredXCMS</span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span>

<span class="va">xdFilt</span>
<span class="co">#&gt; MSn experiment data ("XCMSnExp")</span>
<span class="co">#&gt; Object size in memory: 1.54 Mb</span>
<span class="co">#&gt; - - - Spectra data - - -</span>
<span class="co">#&gt;  MS level(s): 1 </span>
<span class="co">#&gt;  Number of spectra: 5200 </span>
<span class="co">#&gt;  MSn retention times: 0:02 - 11:18 minutes</span>
<span class="co">#&gt; - - - Processing information - - -</span>
<span class="co">#&gt; Data loaded [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt; Filter: select MS level(s) 1. [Sat May 14 18:36:03 2022] </span>
<span class="co">#&gt;  MSnbase version: 2.20.4 </span>
<span class="co">#&gt; - - - Meta data  - - -</span>
<span class="co">#&gt; phenoData</span>
<span class="co">#&gt;   rowNames: 1 2 3 4</span>
<span class="co">#&gt;   varLabels: sample_name sample_group</span>
<span class="co">#&gt;   varMetadata: labelDescription</span>
<span class="co">#&gt; Loaded from:</span>
<span class="co">#&gt;   [1] hilic015.mzML...  [4] hilic021.mzML</span>
<span class="co">#&gt;   Use 'fileNames(.)' to see all files.</span>
<span class="co">#&gt; protocolData: none</span>
<span class="co">#&gt; featureData</span>
<span class="co">#&gt;   featureNames: F1.S0001 F1.S0002 ... F4.S1300 (5200 total)</span>
<span class="co">#&gt;   fvarLabels: fileIdx spIdx ... spectrum (35 total)</span>
<span class="co">#&gt;   fvarMetadata: labelDescription</span>
<span class="co">#&gt; experimentData: use 'experimentData(object)'</span>
<span class="co">#&gt; - - - xcms preprocessing - - -</span>
<span class="co">#&gt; Chromatographic peak detection:</span>
<span class="co">#&gt;  method: centWave </span>
<span class="co">#&gt;  923 peaks identified in 4 samples.</span>
<span class="co">#&gt;  On average 231 chromatographic peaks per sample.</span>

<span class="co"># get the filtered peak table</span>
<span class="va">xcmsPeaktableFilt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdFilt</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get the filtered cpc peak table</span>
<span class="va">cpcPeaktableFilt</span> <span class="op">&lt;-</span> <span class="va">cpcPeaktable</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">xcmsPeaktableFilt</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<p>In the original XCMS object there were 1110 peaks identified across 4
files. After filtering using our processing, 913 peaks remain.</p>
<p>To see how many peaks were removed in a file-by-file basis you can
use the table function on the chromatographic peak table from the xcms
object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>Original <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">xcmsPeaktableOrig</span><span class="op">[</span>, <span class="st">"sample"</span><span class="op">]</span><span class="op">)</span>,
      Filtered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">xcmsPeaktableFilt</span><span class="op">[</span>, <span class="st">"sample"</span><span class="op">]</span><span class="op">)</span>,
      PercentKept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdFilt</span><span class="op">)</span><span class="op">[</span>, <span class="st">"sample"</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> 
        <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdOrig</span><span class="op">)</span><span class="op">[</span>, <span class="st">"sample"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                 1     2     3     4</span>
<span class="co">#&gt; Original    268.0 296.0 264.0 282.0</span>
<span class="co">#&gt; Filtered    226.0 238.0 221.0 238.0</span>
<span class="co">#&gt; PercentKept  84.3  80.4  83.7  84.4</span></code></pre></div>
<p>The filtering outcomes can be extracted from the object using the
<em>getFilterOutcomes()</em> method. This returns a data.frame
indicating if a peak passed the filter criteria or not for the different
filter characteristics.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu">getFilterOutcomes</span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span>
<span class="co">#&gt;        detected    sn width fwhm   tf intensity</span>
<span class="co">#&gt; CP0001     TRUE FALSE FALSE TRUE TRUE      TRUE</span>
<span class="co">#&gt; CP0002     TRUE  TRUE  TRUE TRUE TRUE      TRUE</span>
<span class="co">#&gt; CP0003     TRUE  TRUE  TRUE TRUE TRUE      TRUE</span>
<span class="co">#&gt; CP0004     TRUE  TRUE  TRUE TRUE TRUE      TRUE</span>
<span class="co">#&gt; CP0005     TRUE  TRUE  TRUE TRUE TRUE      TRUE</span>
<span class="co">#&gt; CP0006     TRUE  TRUE  TRUE TRUE TRUE      TRUE</span></code></pre></div>
<p>In the example presented here we have the peak width, peak area, and
signal-to-noise ratio filters active. For that reason the other filters
just show TRUE for all peaks as they were not filtered based on
this.</p>
<p>To check which peaks are retained and which are removed, the outcomes
data.frame can be used. A character vector of removed and retained peak
IDs can also be obtained using the <em>getRemovedPeaks()</em> and
<em>getRetainedPeaks()</em> methods, respectively. We can visualize the
filtering outcomes using a Venn diagram.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># setup a list for the Venn diagram</span>
<span class="va">outcomesList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="co"># output a Venn diagram for the used filters</span>
<span class="fu">ggvenn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggvenn/man/ggvenn.html" class="external-link">ggvenn</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">outcomesList</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span>, show_percentage <span class="op">=</span> <span class="cn">FALSE</span>,
               stroke_size <span class="op">=</span> <span class="fl">0.5</span>, set_name_size <span class="op">=</span> <span class="fl">4</span>, text_size <span class="op">=</span> <span class="fl">2.8</span>,
               fill_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#868686FF"</span>, <span class="st">"#0073C2FF"</span>, <span class="st">"#CD534CFF"</span>,
                              <span class="st">"#EFC000FF"</span>, <span class="st">"#073b4cFF"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in sprintf("%d", n, 100 * n/sum(n)): one argument not used by format</span>
<span class="co">#&gt; '%d'</span></code></pre></div>
<p><img src="cpc_files/figure-html/venn-diagram-1.png" width="700"></p>
<p>We can see that 8 peaks were not detected at all, ie. did not exhibit
the characteristic pattern in the second derivative. Apart from those,
the majority of peaks were removed due to their signal-to-noise being
too low (SN&lt;10).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># set a seed for sample() to make it reproducible</span>
<span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">12345</span>

<span class="co"># as an example we will select 2 peaks from each filter outcome</span>
<span class="co"># (1) Not detected as a peak,</span>
<span class="co"># (2) Too low signal-to-noise,</span>
<span class="co"># (3) Too low intensity (only 1 peak here)</span>
<span class="co"># (4) Too narrow</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span>; <span class="va">randomRemoved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  nd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co"># (1)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">!</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> 
             <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,
  lowsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co"># (2)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> 
             <span class="op">!</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,
  lowint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co"># (3)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> 
             <span class="op">!</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="op">!</span><span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span><span class="op">)</span>,
  toonarrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co"># (4)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> 
             <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="op">!</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&amp;</span>
             <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">randomRemoved</span>
<span class="co">#&gt; $nd</span>
<span class="co">#&gt; CP0661 CP0352 </span>
<span class="co">#&gt;    661    352 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lowsn</span>
<span class="co">#&gt; CP1033 CP0359 </span>
<span class="co">#&gt;   1033    359 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lowint</span>
<span class="co">#&gt; CP0245 </span>
<span class="co">#&gt;    245 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $toonarrow</span>
<span class="co">#&gt; CP0906 CP0549 </span>
<span class="co">#&gt;    906    549</span></code></pre></div>
<p>And then we can plot these peaks using the <em>plotPeaks()</em>
function. This function takes a <em>cpc</em> object as well as a list of
peak IDs as argument. The peak IDs can be supplied as indices in the
full peak list (ie. not the filtered peak list) or as a character vector
with peak IDs (row names in the peak tables). In the present example
they are the same and we can use either the names of randomRemoved or
the values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRemoved</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic017.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-selected-peaks-1.png" width="672"></p>
<pre><code><span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic019.mzML</span></code></pre>
<p><img src="cpc_files/figure-html/plot-selected-peaks-2.png" width="672"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRemoved</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic017.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-selected-peaks-3.png" width="672"></p>
<pre><code><span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic021.mzML</span></code></pre>
<p><img src="cpc_files/figure-html/plot-selected-peaks-4.png" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRemoved</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-selected-peaks-5.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRemoved</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic017.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-selected-peaks-6.png" width="672"></p>
<pre><code><span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic021.mzML</span></code></pre>
<p><img src="cpc_files/figure-html/plot-selected-peaks-7.png" width="672"></p>
<p>In the above plots the original XIC trace is plotted as a gray dashed
line with the smoothed chromatogram overlaid on top in black. The black
dots are the actual scan points. The blue circles represent the front
boundary, apex location, and tail boundary, as determined by XCMS. The
red fill indicates the peak boundaries determined by CPC with the red
dot representing the apex point. The red dashed line is the baseline of
the peak, as estimated by CPC.</p>
<p>We can also plot some of the retained peaks in the same way. Here we
will randomly select one peak from each quartile of the signal-to-noise
range.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># get a vector of all detected peaks</span>
<span class="va">allRetainedPeaks</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu">getRetainedPeaks</span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span>
<span class="va">allRetainedPeakIdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">allRetainedPeaks</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">cpcPeaktable</span><span class="op">)</span><span class="op">)</span>

<span class="co"># determine the quartile break points</span>
<span class="va">quarts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span><span class="op">)</span>
<span class="va">quarts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># set the first boundary to be 0</span>

<span class="va">quarts</span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt;   0.00000  28.49219  64.91197 161.98079       Inf</span>

<span class="co"># randomly select peaks in each quartile</span>
<span class="va">noPeakFromEachQuartile</span> <span class="op">&lt;-</span> <span class="fl">2</span>

<span class="co"># randomly select the specified number of peaks from each quartile</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span>; <span class="va">randomRetained</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  <span class="va">low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">allRetainedPeaks</span><span class="op">[</span>
    <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> 
      <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="op">]</span>, <span class="va">noPeakFromEachQuartile</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="co"># 0% &lt;= SN &lt; 25%</span>
  <span class="va">lowmed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">allRetainedPeaks</span><span class="op">[</span>
    <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> 
      <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  <span class="op">]</span>, <span class="va">noPeakFromEachQuartile</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="co"># 25% &lt;= SN &lt; 50%</span>
  <span class="va">medhigh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">allRetainedPeaks</span><span class="op">[</span>
    <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span> 
      <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>
  <span class="op">]</span>, <span class="va">noPeakFromEachQuartile</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="co"># 50% &lt;= SN &lt; 75%</span>
  <span class="va">high</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">allRetainedPeaks</span><span class="op">[</span>
    <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&amp;</span> 
      <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span><span class="op">[</span><span class="va">allRetainedPeakIdx</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">quarts</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>
  <span class="op">]</span>, <span class="va">noPeakFromEachQuartile</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="co"># 75% &lt;= SN &lt; 100%</span>

<span class="va">randomRetained</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "CP0644" "CP0246"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "CP1018" "CP1072"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "CP1048" "CP0709"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] "CP0253" "CP0470"</span></code></pre></div>
<p>And then we can plot all these peaks in the same way as with the
removed peaks.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRetained</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-retained-peaks-1.png" width="672"></p>
<pre><code><span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic019.mzML</span></code></pre>
<p><img src="cpc_files/figure-html/plot-retained-peaks-2.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRetained</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic021.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-retained-peaks-3.png" width="672"><img src="cpc_files/figure-html/plot-retained-peaks-4.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRetained</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic019.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-retained-peaks-5.png" width="672"></p>
<pre><code><span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic021.mzML</span></code></pre>
<p><img src="cpc_files/figure-html/plot-retained-peaks-6.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">randomRetained</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-retained-peaks-7.png" width="672"></p>
<pre><code><span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic017.mzML</span></code></pre>
<p><img src="cpc_files/figure-html/plot-retained-peaks-8.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># get a vector of all removed peak numeric IDs</span>
<span class="va">removedPeaksIdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu">cpc</span><span class="fu">::</span><span class="fu">getRemovedPeaks</span><span class="op">(</span><span class="va">cpc</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">cpcPeaktable</span><span class="op">)</span><span class="op">)</span>

<span class="va">snVals</span> <span class="op">&lt;-</span> <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">sn</span>
<span class="va">snVals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">snVals</span> <span class="op">==</span> <span class="cn">Inf</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">snVals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">snVals</span> <span class="op">!=</span> <span class="cn">Inf</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>
<span class="va">quanBreaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">snVals</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span>
<span class="va">quanBreaks</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="va">colPalette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>, 
                                          <span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">16</span><span class="op">)</span>

<span class="va">colVec</span> <span class="op">&lt;-</span> <span class="va">colPalette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">snVals</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">quanBreaks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quanBreaks</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">x</span> <span class="op">&amp;</span>
          <span class="va">quanBreaks</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pSet-class.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quanBreaks</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">x</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>

<span class="co"># m/z ~ rt (xcms data) with separate panels for retained and removed peaks</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.53</span>,<span class="fl">0.47</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>,<span class="fl">4.1</span>,<span class="fl">2.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, 
     y <span class="op">=</span> <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, 
     col <span class="op">=</span> <span class="va">colVec</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span>,
     cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">into</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> 
                 <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">into</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">"Retention time (sec)"</span>, ylab <span class="op">=</span> <span class="st">"m/z"</span>, main <span class="op">=</span> <span class="st">"Retained peaks"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>,<span class="fl">0</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, 
     y <span class="op">=</span> <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, 
     col <span class="op">=</span> <span class="va">colVec</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span>,
     cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">into</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> 
                 <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">into</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">"Retention time (sec)"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Removed peaks"</span><span class="op">)</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-peak-locations-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># m/z ~ rt (cpc data) with separate panels for retained and removed peaks</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.53</span>,<span class="fl">0.47</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>,<span class="fl">4.1</span>,<span class="fl">2.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, 
     y <span class="op">=</span> <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, 
     col <span class="op">=</span> <span class="va">colVec</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span>,
     cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> 
                 <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="op">-</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">"Retention time (sec)"</span>, ylab <span class="op">=</span> <span class="st">"m/z"</span>, main <span class="op">=</span> <span class="st">"Retained peaks"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>,<span class="fl">0</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, 
     y <span class="op">=</span> <span class="va">xcmsPeaktableOrig</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, 
     col <span class="op">=</span> <span class="va">colVec</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span>,
     cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> 
                 <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="va">removedPeaksIdx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">"Retention time (sec)"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Removed peaks"</span><span class="op">)</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-peak-locations-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="peak-cluster-boundaries">Peak cluster boundaries<a class="anchor" aria-label="anchor" href="#peak-cluster-boundaries"></a>
</h2>
<p>Overlapping peak clusters can be detected by the algorithm as their
baseline boundaries after expansion will overlap. Consequently the
boundaries between peaks in clusters need to be determined and updated.
This is handled differently depending on the degree of overlap. Valley
boundaries between peaks are set to the lowest point between the peak
apices along the ion trace. Shoulder boundaries are set to the maxima
between the peak apices along the second derivative of the ion trace.
When two similarily sized peaks overlap sufficiently much, it can lead
to a rounded peak shape. This is detected as two peak apices that share
inflection points along the second derivative which a negative valued
maxima in between the apice points. The boundary is then set to the
negative maxima point between the apices.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Valley boundary example</span>
<span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, <span class="fl">931</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic021.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-examples-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Shoulder boundary example</span>
<span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, <span class="fl">500</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic017.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-examples-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="example-of-emg-deconvolution">Example of EMG deconvolution<a class="anchor" aria-label="anchor" href="#example-of-emg-deconvolution"></a>
</h2>
<p>The processing engine used in the CPC package includes EMG
deconvolution of peak clusters to achieve better estimates of the peak
boundaries. This can be included in the processing by setting the
argument <em>fit_emg = TRUE</em> in the <em>cpcProcParam</em>
object.</p>
<p>To illustrate this, we first need to find a few peaks to perform EMG
deconvolution on.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="op">(</span><span class="va">selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">34</span>, <span class="fl">138</span>, <span class="fl">106</span>, <span class="fl">165</span>, <span class="fl">179</span>, <span class="fl">217</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1]  34 138 106 165 179 217</span>

<span class="op">(</span><span class="va">peakIdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">cpcPeaktable</span><span class="op">[</span><span class="va">selection</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "CP0034" "CP0138" "CP0106" "CP0165" "CP0179" "CP0217"</span>

<span class="op">(</span><span class="va">selection</span> <span class="op">&lt;-</span> <span class="va">cpcPeaktable</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">selection</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1]  34 138 106 165 179 217</span>

<span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span><span class="va">cpc</span>, peakIdx <span class="op">=</span> <span class="va">selection</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/select-and-plot-emg-examples-1.png" width="700"><img src="cpc_files/figure-html/select-and-plot-emg-examples-2.png" width="700"><img src="cpc_files/figure-html/select-and-plot-emg-examples-3.png" width="700"><img src="cpc_files/figure-html/select-and-plot-emg-examples-4.png" width="700"><img src="cpc_files/figure-html/select-and-plot-emg-examples-5.png" width="700"><img src="cpc_files/figure-html/select-and-plot-emg-examples-6.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cpcParam</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/cpcProcParam.html">cpcProcParam</a></span><span class="op">(</span>fit_emg <span class="op">=</span> <span class="cn">TRUE</span>, sel_peaks <span class="op">=</span> <span class="va">selection</span>, plot <span class="op">=</span> <span class="cn">F</span>,
                              save_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cpcDeconv</span> <span class="op">&lt;-</span> <span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/characterize_xcms_peaklist.html">characterize_xcms_peaklist</a></span><span class="op">(</span>xd <span class="op">=</span> <span class="va">xd</span>, param <span class="op">=</span> <span class="va">cpcParam</span><span class="op">)</span>
<span class="co">#&gt; Processing file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span>
<span class="co">#&gt; Found 6 peak(s).</span>
<span class="co">#&gt; Finished in 0.547 secs.</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">cpc</span><span class="fu">::</span><span class="fu"><a href="../reference/plotPeaks.html">plotPeaks</a></span><span class="op">(</span>cpc <span class="op">=</span> <span class="va">cpcDeconv</span>, peakIdx <span class="op">=</span> <span class="va">peakIdx</span>, plotEMG <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; Opening file: /__w/_temp/Library/cpc/extdata/hilic015.mzML</span></code></pre></div>
<p><img src="cpc_files/figure-html/plot-result-cpc-emg-1.png" width="700"><img src="cpc_files/figure-html/plot-result-cpc-emg-2.png" width="700"><img src="cpc_files/figure-html/plot-result-cpc-emg-3.png" width="700"><img src="cpc_files/figure-html/plot-result-cpc-emg-4.png" width="700"><img src="cpc_files/figure-html/plot-result-cpc-emg-5.png" width="700"><img src="cpc_files/figure-html/plot-result-cpc-emg-6.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.3 (2022-03-10)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 20.04.4 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] grid      stats4    stats     graphics  grDevices utils     datasets </span>
<span class="co">#&gt; [8] methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] ggvenn_0.1.9        ggplot2_3.3.6       dplyr_1.0.9        </span>
<span class="co">#&gt;  [4] cpc_0.1.0           signal_0.7-7        xcms_3.16.1        </span>
<span class="co">#&gt;  [7] MSnbase_2.20.4      ProtGenerics_1.26.0 S4Vectors_0.32.4   </span>
<span class="co">#&gt; [10] mzR_2.28.0          Rcpp_1.0.8.3        Biobase_2.54.0     </span>
<span class="co">#&gt; [13] BiocGenerics_0.40.0 BiocParallel_1.28.3 pander_0.6.5       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] bitops_1.0-7                matrixStats_0.62.0         </span>
<span class="co">#&gt;  [3] fs_1.5.2                    progress_1.2.2             </span>
<span class="co">#&gt;  [5] doParallel_1.0.17           RColorBrewer_1.1-3         </span>
<span class="co">#&gt;  [7] rprojroot_2.0.3             GenomeInfoDb_1.30.1        </span>
<span class="co">#&gt;  [9] tools_4.1.3                 bslib_0.3.1                </span>
<span class="co">#&gt; [11] utf8_1.2.2                  R6_2.5.1                   </span>
<span class="co">#&gt; [13] affyio_1.64.0               colorspace_2.0-3           </span>
<span class="co">#&gt; [15] withr_2.5.0                 prettyunits_1.1.1          </span>
<span class="co">#&gt; [17] tidyselect_1.1.2            MassSpecWavelet_1.60.1     </span>
<span class="co">#&gt; [19] compiler_4.1.3              preprocessCore_1.56.0      </span>
<span class="co">#&gt; [21] textshaping_0.3.6           cli_3.3.0                  </span>
<span class="co">#&gt; [23] DelayedArray_0.20.0         desc_1.4.1                 </span>
<span class="co">#&gt; [25] labeling_0.4.2              sass_0.4.1                 </span>
<span class="co">#&gt; [27] scales_1.2.0                DEoptimR_1.0-11            </span>
<span class="co">#&gt; [29] robustbase_0.95-0           affy_1.72.0                </span>
<span class="co">#&gt; [31] pkgdown_2.0.3.9000          systemfonts_1.0.4          </span>
<span class="co">#&gt; [33] stringr_1.4.0               digest_0.6.29              </span>
<span class="co">#&gt; [35] rmarkdown_2.14              XVector_0.34.0             </span>
<span class="co">#&gt; [37] pkgconfig_2.0.3             htmltools_0.5.2            </span>
<span class="co">#&gt; [39] MatrixGenerics_1.6.0        highr_0.9                  </span>
<span class="co">#&gt; [41] fastmap_1.1.0               limma_3.50.3               </span>
<span class="co">#&gt; [43] rlang_1.0.2                 impute_1.68.0              </span>
<span class="co">#&gt; [45] farver_2.1.0                jquerylib_0.1.4            </span>
<span class="co">#&gt; [47] generics_0.1.2              jsonlite_1.8.0             </span>
<span class="co">#&gt; [49] mzID_1.32.0                 RCurl_1.98-1.6             </span>
<span class="co">#&gt; [51] magrittr_2.0.3              GenomeInfoDbData_1.2.7     </span>
<span class="co">#&gt; [53] Matrix_1.4-1                MALDIquant_1.21            </span>
<span class="co">#&gt; [55] munsell_0.5.0               fansi_1.0.3                </span>
<span class="co">#&gt; [57] MsCoreUtils_1.6.2           lifecycle_1.0.1            </span>
<span class="co">#&gt; [59] vsn_3.62.0                  stringi_1.7.6              </span>
<span class="co">#&gt; [61] yaml_2.3.5                  MASS_7.3-57                </span>
<span class="co">#&gt; [63] SummarizedExperiment_1.24.0 zlibbioc_1.40.0            </span>
<span class="co">#&gt; [65] plyr_1.8.7                  parallel_4.1.3             </span>
<span class="co">#&gt; [67] crayon_1.5.1                lattice_0.20-45            </span>
<span class="co">#&gt; [69] MsFeatures_1.2.0            hms_1.1.1                  </span>
<span class="co">#&gt; [71] knitr_1.39                  pillar_1.7.0               </span>
<span class="co">#&gt; [73] GenomicRanges_1.46.1        codetools_0.2-18           </span>
<span class="co">#&gt; [75] XML_3.99-0.9                glue_1.6.2                 </span>
<span class="co">#&gt; [77] evaluate_0.15               pcaMethods_1.86.0          </span>
<span class="co">#&gt; [79] BiocManager_1.30.17         vctrs_0.4.1                </span>
<span class="co">#&gt; [81] foreach_1.5.2               RANN_2.6.1                 </span>
<span class="co">#&gt; [83] gtable_0.3.0                purrr_0.3.4                </span>
<span class="co">#&gt; [85] clue_0.3-60                 cachem_1.0.6               </span>
<span class="co">#&gt; [87] xfun_0.31                   ragg_1.2.2                 </span>
<span class="co">#&gt; [89] ncdf4_1.19                  snow_0.4-4                 </span>
<span class="co">#&gt; [91] tibble_3.1.7                iterators_1.0.14           </span>
<span class="co">#&gt; [93] memoise_2.0.1               IRanges_2.28.0             </span>
<span class="co">#&gt; [95] cluster_2.1.3               ellipsis_0.3.2</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kristian Pirttilä.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
